#pragma once
#ifndef WEB_CONFIG_HTML_H
#define WEB_CONFIG_HTML_H

#include <Arduino.h>

// Store large HTML/CSS/JavaScript blocks in PROGMEM to save RAM and reduce code size
// This file contains all the static web assets that were previously in web_config.cpp

const char HTML_CSS[] PROGMEM = R"rawliteral(
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css');
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Roboto',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background-color:#0f172a;color:#f8fafc;min-height:100vh;line-height:1.6;display:flex;flex-direction:column;overflow-x:hidden}
::-webkit-scrollbar{width:8px;height:8px}
::-webkit-scrollbar-track{background:#1e293b}
::-webkit-scrollbar-thumb{background:#475569;border-radius:4px}
::-webkit-scrollbar-thumb:hover{background:#64748b}
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(15,23,42,0.8);backdrop-filter:blur(4px)}
.modal.show{display:flex;align-items:center;justify-content:center;animation:fadeIn 0.2s ease}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal-content{background:#1e293b;border:1px solid #334155;border-radius:16px;padding:2rem;max-width:500px;box-shadow:0 25px 50px -12px rgba(0,0,0,0.5);animation:slideUp 0.3s ease}
@keyframes slideUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}
.modal-header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;color:#f1f5f9;border-bottom:1px solid #334155;padding-bottom:1rem}
.modal-title{font-size:1.5rem;font-weight:bold;flex:1}
.modal-close{background:none;border:none;color:#94a3b8;font-size:1.5rem;cursor:pointer;padding:0;width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all 0.2s}
.modal-close:hover{background:rgba(239,68,68,0.1);color:#f8fafc}
.modal-body{margin-bottom:1.5rem;color:#cbd5e1;line-height:1.6}
.modal-footer{display:flex;gap:1rem;justify-content:flex-end}
.modal-btn{padding:0.75rem 1.5rem;border:none;border-radius:8px;font-weight:500;cursor:pointer;transition:all 0.2s;font-size:0.95rem;letter-spacing:0.5px}
.modal-btn-confirm{background:#0ea5e9;color:white}
.modal-btn-confirm:hover{background:#0284c7;transform:translateY(-1px);box-shadow:0 4px 12px rgba(14,165,233,0.4)}
.modal-btn-cancel{background:#475569;color:white}
.modal-btn-cancel:hover{background:#334155}
.modal-success{border-left:4px solid #10b981}
.modal-error{border-left:4px solid #ef4444}
.modal-warning{border-left:4px solid #f59e0b}
.header{background:#1e293b;padding:1rem 0;box-shadow:0 4px 6px -1px rgba(0,0,0,0.3);border-bottom:1px solid #334155}
.container{max-width:1200px;margin:0 auto;padding:0 1rem}
.header-content{display:flex;justify-content:space-between;align-items:center;color:#f8fafc;flex-wrap:wrap;gap:1rem}
.logo{font-size:1.5rem;font-weight:bold;color:#38bdf8;letter-spacing:-0.5px}
.status-badges{display:flex;gap:0.5rem;flex-wrap:wrap;align-items:center}
.badge{padding:0.35rem 0.85rem;border-radius:9999px;font-size:0.75rem;font-weight:600;letter-spacing:0.5px;text-transform:uppercase}
.badge.success{background:#059669;color:#ecfdf5}
.badge.error{background:#dc2626;color:#fef2f2}
.badge.warning{background:#d97706;color:#fffbeb}
.github-link{display:inline-flex;align-items:center;padding:0.5rem 0.9rem;background:#334155;color:#e2e8f0;border-radius:8px;text-decoration:none;font-size:0.85rem;border:1px solid #475569;transition:all 0.2s ease;white-space:nowrap;font-weight:500}
.github-link:hover{background:#475569;border-color:#64748b;transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,0.3)}
.github-link .github-icon{font-family:'Font Awesome 6 Brands';margin-right:0.4rem}
.nav{background:#0f172a;padding:0;border-bottom:1px solid #334155;position:sticky;top:0;z-index:100;backdrop-filter:blur(8px);background:rgba(15,23,42,0.95)}
.nav-content{display:flex;gap:0.35rem;padding:0.5rem 0;justify-content:center;overflow-x:auto;flex-wrap:nowrap}
.nav-item{padding:0.6rem 0.9rem;border-radius:8px;text-decoration:none;color:#94a3b8;white-space:nowrap;transition:all 0.2s ease;font-weight:500;font-size:0.875rem;flex:0 0 auto}
.nav-item:hover{background:#1e293b;color:#38bdf8}
.nav-item.active{background:#1e293b;color:#38bdf8;box-shadow:inset 0 -2px 0 #38bdf8}
.main{padding:2rem 0;flex:1}
.card{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;box-shadow:0 4px 6px -1px rgba(0,0,0,0.3);transition:transform 0.2s ease,box-shadow 0.2s ease;display:flex;flex-direction:column;height:100%}
.card:hover{transform:translateY(-2px);box-shadow:0 10px 15px -3px rgba(0,0,0,0.4);border-color:#475569}
.card h2{margin-bottom:1.25rem;color:#f8fafc;display:flex;align-items:center;gap:0.75rem;font-weight:600;font-size:1.25rem;border-bottom:1px solid #334155;padding-bottom:0.75rem}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}
.form-group{margin-bottom:1.25rem}
.form-group label{display:block;margin-bottom:0.5rem;font-weight:500;color:#cbd5e1;font-size:0.9rem}
.form-control{width:100%;padding:0.75rem;border:1px solid #475569;border-radius:8px;font-size:1rem;background:#334155;color:#f8fafc;transition:border-color 0.2s ease,box-shadow 0.2s ease}
.form-control:focus{outline:none;border-color:#38bdf8;box-shadow:0 0 0 3px rgba(56,189,248,0.2);background:#1e293b}
.form-control::placeholder{color:#64748b}
.btn{display:inline-flex;align-items:center;justify-content:center;padding:0.75rem 1.5rem;border:none;border-radius:8px;text-decoration:none;font-weight:500;cursor:pointer;transition:all 0.2s ease;font-size:0.95rem;letter-spacing:0.3px}
.btn-primary{background:#0ea5e9;color:white}
.btn-primary:hover{background:#0284c7;transform:translateY(-1px);box-shadow:0 4px 12px rgba(14,165,233,0.3)}
.btn-success{background:#10b981;color:white}
.btn-success:hover{background:#059669;transform:translateY(-1px);box-shadow:0 4px 12px rgba(16,185,129,0.3)}
.btn-danger{background:#ef4444;color:white}
.btn-danger:hover{background:#dc2626;transform:translateY(-1px);box-shadow:0 4px 12px rgba(239,68,68,0.3)}
.btn-secondary{background:#475569;color:white}
.btn-secondary:hover{background:#334155;transform:translateY(-1px)}
.status-indicator{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:0.75rem}
@keyframes pulse-green{0%{box-shadow:0 0 0 0 rgba(16,185,129,0.7)}70%{box-shadow:0 0 0 6px rgba(16,185,129,0)}100%{box-shadow:0 0 0 0 rgba(16,185,129,0)}}
.status-online{background:#10b981;animation:pulse-green 2s infinite}
.status-offline{background:#ef4444;box-shadow:0 0 10px rgba(239,68,68,0.5)}
.status-warning{background:#f59e0b;box-shadow:0 0 10px rgba(245,158,11,0.5)}
.progress{background:#334155;border-radius:9999px;height:12px;overflow:hidden;border:none}
.progress-bar{background:linear-gradient(90deg,#38bdf8,#0ea5e9);height:100%;transition:width 0.3s ease}
.stats{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:2rem}
.stat-card{background:#1e293b;padding:1.5rem;border-radius:12px;text-align:center;color:#f8fafc;border:1px solid #334155;transition:transform 0.2s ease;position:relative;overflow:hidden}
.stat-card:hover{transform:translateY(-2px);border-color:#475569;box-shadow:0 10px 15px -3px rgba(0,0,0,0.3)}
.stat-value{font-size:2.25rem;font-weight:700;margin-bottom:0.25rem;color:#38bdf8;letter-spacing:-1px;position:relative;z-index:2}
.stat-label{font-size:0.875rem;font-weight:500;color:#94a3b8;text-transform:uppercase;letter-spacing:0.5px;position:relative;z-index:2}
.stat-icon{position:absolute;right:10px;bottom:0px;font-size:4rem;opacity:0.05;color:#f8fafc;z-index:1;transform:rotate(-15deg)}
.footer{text-align:center;padding:2rem 1rem;color:#64748b;border-top:1px solid #334155;margin-top:auto;font-size:0.9rem}
@media(max-width:1024px){.stats{grid-template-columns:repeat(2,1fr)}}
@media(max-width:768px){.header-content{flex-direction:column;gap:1rem;text-align:center}.nav-item{padding:0.5rem 0.7rem;font-size:0.8rem}.grid{grid-template-columns:1fr}}
@media(max-width:600px){.nav-item{padding:0.4rem 0.5rem;font-size:0.75rem}.stats{grid-template-columns:1fr}}
.error{border-left:4px solid #ef4444}.warning{border-left:4px solid #f59e0b}.success{border-left:4px solid #10b981}
.image-source-item{background:#0f172a !important;border:1px solid #334155 !important;padding:1.25rem !important}
.transform-section{background:#1e293b !important;border:1px dashed #475569 !important}
.toast{position:fixed;top:20px;right:20px;background:#1e293b;color:#fff;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.5);z-index:10000;min-width:300px;max-width:500px;border-left:4px solid #38bdf8;animation:slideInRight 0.3s ease,fadeOut 0.3s ease 2.7s;display:flex;align-items:center;gap:0.75rem}
@keyframes slideInRight{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes fadeOut{to{opacity:0;transform:translateX(400px)}}
.toast.success{border-left-color:#10b981;background:#1e293b}
.toast.error{border-left-color:#ef4444;background:#1e293b}
.toast.warning{border-left-color:#f59e0b;background:#1e293b}
.toast.info{border-left-color:#38bdf8;background:#1e293b}
.toast-icon{font-size:1.5rem;flex-shrink:0}
.toast-content{flex:1}
.toast-message{margin:0;font-weight:500;color:#f8fafc}
.toast-close{background:none;border:none;color:#94a3b8;cursor:pointer;padding:0;font-size:1.2rem;transition:color 0.2s}
.toast-close:hover{color:#f8fafc}
.spinner{border:4px solid #334155;border-top-color:#38bdf8;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:0 auto}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:9999;backdrop-filter:blur(4px)}
.loading-content{background:#1e293b;padding:2rem;border-radius:12px;text-align:center;color:#f8fafc;min-width:300px;border:1px solid #334155;box-shadow:0 25px 50px -12px rgba(0,0,0,0.5)}
.loading-text{margin:1rem 0 0;font-size:1.1rem;color:#cbd5e1}
*:focus{outline:2px solid #38bdf8;outline-offset:2px}
.btn:focus,.form-control:focus{box-shadow:0 0 0 3px rgba(56,189,248,0.3)}
.nav-toggle{display:none;background:none;border:none;color:#f8fafc;font-size:1.5rem;cursor:pointer;padding:0.5rem}
@media (max-width:768px){.nav-toggle{display:block;position:absolute;right:1rem;top:50%;transform:translateY(-50%)}.nav-content{display:none;flex-direction:column;position:absolute;top:100%;left:0;right:0;background:#0f172a;padding:0;box-shadow:0 4px 6px rgba(0,0,0,0.3);border-top:1px solid #334155}.nav-content.active{display:flex}.nav-item{padding:1rem;width:100%;text-align:left;border-bottom:1px solid #1e293b}.nav{position:relative}}
)rawliteral";

const char HTML_JAVASCRIPT[] PROGMEM = R"rawliteral(
function showToast(message,type='info'){const icons={success:'fa-check-circle',error:'fa-exclamation-circle',warning:'fa-exclamation-triangle',info:'fa-info-circle'};const colors={success:'#10b981',error:'#ef4444',warning:'#f59e0b',info:'#38bdf8'};const toast=document.createElement('div');toast.className='toast '+type;toast.innerHTML='<i class="fas '+icons[type]+' toast-icon"></i><div class="toast-content"><p class="toast-message">'+message+'</p></div><button class="toast-close" onclick="this.parentElement.remove()">&times;</button>';document.body.appendChild(toast);setTimeout(()=>toast.remove(),3000)}
function showLoading(message='Working...'){const overlay=document.createElement('div');overlay.className='loading-overlay';overlay.id='loadingOverlay';overlay.innerHTML='<div class="loading-content"><div class="spinner"></div><p class="loading-text">'+message+'</p></div>';document.body.appendChild(overlay);return overlay}
function hideLoading(){const overlay=document.getElementById('loadingOverlay');if(overlay)overlay.remove()}
function showButtonFeedback(btn,type,message){if(!btn)return;const originalContent=btn.getAttribute('data-original-content')||btn.innerHTML;if(!btn.getAttribute('data-original-content')){btn.setAttribute('data-original-content',originalContent)}const originalClass=btn.getAttribute('data-original-class')||btn.className;if(!btn.getAttribute('data-original-class')){btn.setAttribute('data-original-class',originalClass)}if(type==='loading'){btn.disabled=true;btn.innerHTML='<i class="fas fa-circle-notch fa-spin"></i> '+(message||'Working...');return}btn.disabled=false;if(type==='success'){btn.className='btn btn-success';btn.innerHTML='<i class="fas fa-check"></i> '+(message||'Saved')}else{btn.className='btn btn-danger';btn.innerHTML='<i class="fas fa-exclamation-triangle"></i> '+(message||'Error')}setTimeout(()=>{btn.innerHTML=originalContent;btn.className=originalClass;btn.disabled=false},2000)}
function showInputFeedback(input,type){const originalBorder=input.style.borderColor;if(type==='success'){input.style.borderColor='#10b981';input.style.boxShadow='0 0 0 3px rgba(16, 185, 129, 0.2)'}else{input.style.borderColor='#ef4444';input.style.boxShadow='0 0 0 3px rgba(239, 68, 68, 0.2)'}setTimeout(()=>{input.style.borderColor='';input.style.boxShadow=''},2000)}
function showModal(title,message,type='info'){const modal=document.getElementById('modal');const modalTitle=document.querySelector('.modal-title');const modalBody=document.querySelector('.modal-body');const modalContent=document.querySelector('.modal-content');if(!modal||!modalTitle||!modalBody||!modalContent)return;modalTitle.innerHTML=title;modalBody.innerHTML=message;modalContent.className='modal-content';if(type==='success')modalContent.classList.add('modal-success');else if(type==='error')modalContent.classList.add('modal-error');else if(type==='warning')modalContent.classList.add('modal-warning');modal.classList.add('show')}
function closeModal(){const modal=document.getElementById('modal');if(modal)modal.classList.remove('show')}
function toggleNav(){const nav=document.querySelector('.nav-content');if(nav)nav.classList.toggle('active')}
function validateImageUrl(input){const url=input.value.trim();if(!url){showInputFeedback(input,'error');return false}if(!url.match(/^https?:\/\/.+/i)){showInputFeedback(input,'error');showToast('URL must start with http:// or https://','error');return false}return true}
function validateRequired(input){if(!input.value.trim()){showInputFeedback(input,'error');showToast('This field is required','error');return false}return true}
function validateNumber(input,min,max){const val=parseFloat(input.value);if(isNaN(val)){showInputFeedback(input,'error');showToast('Please enter a valid number','error');return false}if(min!==undefined&&val<min){showInputFeedback(input,'error');showToast('Value must be at least '+min,'error');return false}if(max!==undefined&&val>max){showInputFeedback(input,'error');showToast('Value must be at most '+max,'error');return false}return true}
function showConfirmModal(title,message,onConfirm,onCancel){const modal=document.getElementById('confirmModal');const modalTitle=document.querySelector('#confirmModal .modal-title');const modalBody=document.querySelector('#confirmModal .modal-body');const confirmBtn=document.querySelector('#confirmModal .modal-btn-confirm');if(!modal||!modalTitle||!modalBody||!confirmBtn)return;modalTitle.innerHTML=title;modalBody.innerHTML=message;modal.classList.add('show');confirmBtn.onclick=()=>{modal.classList.remove('show');if(onConfirm)onConfirm()};const cancelBtn=document.querySelector('#confirmModal .modal-btn-cancel');if(cancelBtn)cancelBtn.onclick=()=>{modal.classList.remove('show');if(onCancel)onCancel()};const closeBtn=document.querySelector('#confirmModal .modal-close');if(closeBtn)closeBtn.onclick=()=>{modal.classList.remove('show');if(onCancel)onCancel()}}
document.addEventListener('DOMContentLoaded',function(){const closeButtons=document.querySelectorAll('.modal-close');closeButtons.forEach(btn=>{btn.onclick=()=>closeModal()})});
function submitForm(formId,endpoint){const form=document.getElementById(formId);if(!form)return;form.addEventListener('submit',function(e){e.preventDefault();const btn=form.querySelector('button[type="submit"]');if(btn)showButtonFeedback(btn,'loading','Saving...');const formData=new FormData(form);fetch(endpoint,{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){if(btn)showButtonFeedback(btn,'success','Saved!');showToast('Settings saved successfully','success');if(data.willRestart){showModal('âœ“ Restarting',data.message,'success');setTimeout(()=>location.reload(),10000)}}else{if(btn)showButtonFeedback(btn,'error','Error');showToast('Error: '+data.message,'error')}}).catch(error=>{if(btn)showButtonFeedback(btn,'error','Failed');showToast('Failed to save settings','error')})})}
document.addEventListener('DOMContentLoaded',function(){submitForm('networkForm','/api/save');submitForm('mqttForm','/api/save');submitForm('imageForm','/api/save');submitForm('displayForm','/api/save');submitForm('advancedForm','/api/save');document.addEventListener('keydown',function(e){if(e.ctrlKey||e.metaKey){switch(e.key){case 's':e.preventDefault();const form=document.querySelector('form');if(form)form.requestSubmit();showToast('Saving...','info');break;case 'r':e.preventDefault();if(confirm('Restart device?'))restart();break;case 'n':e.preventDefault();const nextBtn=document.querySelector('[onclick*=\"nextImage\"]');if(nextBtn)nextBtn.click();break}}});if(window.location.pathname==='/'||window.location.pathname===''){console.log('Dashboard detected, starting auto-refresh...');startDashboardAutoRefresh()}});
function startDashboardAutoRefresh(){refreshDashboard();setInterval(refreshDashboard,5000)}
function refreshDashboard(){console.log('Fetching dashboard data from /api/info...');fetch('/api/info').then(res=>{console.log('Response received:',res.status);return res.json()}).then(data=>{console.log('Dashboard data received:',data);updateDashboardMetrics(data)}).catch(err=>{console.error('Dashboard refresh error:',err)})}
function updateDashboardMetrics(data){if(!data||!data.system){console.error('Invalid data structure');return}console.log('Updating dashboard metrics...');const statCards=document.querySelectorAll('.stat-card .stat-value');if(statCards[0]&&data.system.uptime_seconds){statCards[0].textContent=formatUptime(data.system.uptime_seconds*1000);console.log('Updated uptime:',statCards[0].textContent)}if(statCards[1]){const modeText=data.image&&data.image.cycling_enabled?'Cycling':'Single';statCards[1].textContent=modeText;console.log('Updated mode:',modeText)}if(data.image&&data.image.cycling_enabled){if(statCards[2]){const activeText=(data.image.current_index+1)+'/'+data.image.source_count;statCards[2].textContent=activeText;console.log('Updated active source:',activeText)}if(statCards[3]){const cycleText=(data.image.cycle_interval/1000)+'s';statCards[3].textContent=cycleText;console.log('Updated cycle time:',cycleText)}}else{if(statCards[2]){const updateText=(data.image.update_interval/1000/60)+'m';statCards[2].textContent=updateText;console.log('Updated update interval:',updateText)}if(statCards[3]&&data.display){statCards[3].textContent=data.display.brightness+'%';console.log('Updated brightness:',data.display.brightness+'%')}}if(data.network&&data.network.connected&&data.network.rssi){const wifiCard=Array.from(document.querySelectorAll('.card')).find(c=>c.textContent.includes('Network Status'));if(wifiCard){const gridDivs=wifiCard.querySelectorAll('div[style*=\"grid-template\"] > div');if(gridDivs[1]){gridDivs[1].innerHTML='<strong style=\"color:#64748b\">Signal:</strong><br>'+data.network.rssi+' dBm';console.log('Updated WiFi signal:',data.network.rssi)}}}if(data.mqtt){const mqttCard=Array.from(document.querySelectorAll('.card')).find(c=>c.textContent.includes('MQTT Status'));if(mqttCard){const statusIndicator=mqttCard.querySelector('.status-indicator');const statusText=mqttCard.querySelector('p');if(statusIndicator&&statusText){if(data.mqtt.connected){statusIndicator.className='status-indicator status-online';statusText.innerHTML='<span class=\"status-indicator status-online\"></span>Connected to broker';console.log('Updated MQTT status: Connected')}else{statusIndicator.className='status-indicator status-offline';statusText.innerHTML='<span class=\"status-indicator status-offline\"></span>Not connected';console.log('Updated MQTT status: Disconnected')}}}}if(data.system){const sysCard=Array.from(document.querySelectorAll('.card')).find(c=>c.textContent.includes('System Information'));if(sysCard){const gridDivs=sysCard.querySelectorAll('div[style*=\"grid-template\"] > div');if(gridDivs[2]&&data.system.free_heap){gridDivs[2].innerHTML='<strong style=\"color:#64748b\">Free Heap:</strong><br>'+formatBytes(data.system.free_heap)+' / '+formatBytes(data.system.total_heap);console.log('Updated heap:',formatBytes(data.system.free_heap))}if(gridDivs[3]&&data.system.free_psram){gridDivs[3].innerHTML='<strong style=\"color:#64748b\">Free PSRAM:</strong><br>'+formatBytes(data.system.free_psram)+' / '+formatBytes(data.system.total_psram);console.log('Updated PSRAM:',formatBytes(data.system.free_psram))}if(gridDivs[4]&&data.system.temperature_celsius){gridDivs[4].innerHTML='<strong style=\"color:#64748b\">Temperature:</strong><br>'+data.system.temperature_celsius.toFixed(1)+'\u00b0C / '+data.system.temperature_fahrenheit.toFixed(1)+'\u00b0F';console.log('Updated temperature:',data.system.temperature_celsius.toFixed(1)+'Â°C')}if(gridDivs[5]&&data.system.healthy!==undefined){const healthText=data.system.healthy?'<span style=\"color:#10b981\">Healthy</span>':'<span style=\"color:#ef4444\">Issues</span>';gridDivs[5].innerHTML='<strong style=\"color:#64748b\">Health:</strong><br>'+healthText;console.log('Updated health status:',data.system.healthy?'Healthy':'Issues')}}}if(data.display){const dispCard=Array.from(document.querySelectorAll('.card')).find(c=>c.textContent.includes('Display Information'));if(dispCard){const gridDivs=dispCard.querySelectorAll('div[style*=\"grid-template\"] > div');if(gridDivs[1]&&data.display.brightness!==undefined){const brightnessText=data.display.brightness+'% '+(data.display.brightness_auto_mode?'(Auto)':'(Manual)');gridDivs[1].innerHTML='<strong style=\"color:#64748b\">Brightness:</strong><br>'+brightnessText;console.log('Updated display brightness:',brightnessText)}}}if(data.image){console.log('Image data:',data.image);const imgMode=document.getElementById('imgMode');const imgActive=document.getElementById('imgActive');const imgCycle=document.getElementById('imgCycle');const imgUpdate=document.getElementById('imgUpdate');if(data.image.cycling_enabled){if(imgMode)imgMode.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Mode:</strong> Cycling</p>';if(imgActive)imgActive.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Active:</strong> ['+(data.image.current_index+1)+'/'+data.image.source_count+']</p>';if(imgCycle)imgCycle.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Cycle:</strong> '+(data.image.cycle_interval/1000)+'s</p>';if(imgUpdate)imgUpdate.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Update:</strong> '+(data.image.update_interval/1000/60)+'m</p>';console.log('Updated cycling image status: Source '+(data.image.current_index+1)+'/'+data.image.source_count);const currentIndex=data.image.current_index||0;const sourceCount=data.image.source_count||0;for(let i=0;i<sourceCount;i++){const sourceDiv=document.getElementById('source-'+i);const sourceLabel=document.getElementById('source-label-'+i);const isActive=(i===currentIndex);if(sourceDiv){sourceDiv.style.background=isActive?'#1e3a2e':'#1e293b';sourceDiv.style.borderLeft=isActive?'4px solid #10b981':'4px solid #475569'}if(sourceLabel){const indicatorSpan=sourceLabel.querySelector('span');const strongTag=sourceLabel.querySelector('strong');if(indicatorSpan){indicatorSpan.style.color=isActive?'#10b981':'#64748b';indicatorSpan.style.fontSize=isActive?'1.2rem':'1rem';indicatorSpan.innerHTML=isActive?'â–º':'â€¢'}if(strongTag){strongTag.style.color=isActive?'#10b981':'#64748b';strongTag.textContent='Source '+(i+1)+(isActive?' (Active)':'')}}}}else{if(imgMode)imgMode.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Mode:</strong> Single Image</p>';if(imgUpdate)imgUpdate.innerHTML='<p style=\"margin:0;font-size:0.9rem;color:#94a3b8\"><strong style=\"color:#e2e8f0\">Update:</strong> '+(data.image.update_interval/1000/60)+' minutes</p>';console.log('Updated single image status')}}console.log('Dashboard metrics update complete')}
function formatUptime(ms){const seconds=Math.floor(ms/1000);const days=Math.floor(seconds/86400);const hours=Math.floor((seconds%86400)/3600);const mins=Math.floor((seconds%3600)/60);const secs=seconds%60;if(days>0)return days+'d '+hours+'h';if(hours>0)return hours+'h '+mins+'m';if(mins>0)return mins+'m '+secs+'s';return secs+'s'}
function formatBytes(bytes){if(bytes<1024)return bytes+' B';if(bytes<1048576)return(bytes/1024).toFixed(1)+' KB';return(bytes/1048576).toFixed(2)+' MB'}
function updateBrightnessValue(value){document.getElementById('brightnessValue').textContent=value}
function updateMainBrightnessValue(value){document.getElementById('mainBrightnessValue').textContent=value}
function updateBrightnessMode(isAuto){const slider=document.getElementById('main_brightness');const container=document.getElementById('brightness_slider_container');const saveButton=document.getElementById('save_brightness_btn');const checkbox=document.getElementById('brightness_auto_mode');if(isAuto){slider.disabled=true;saveButton.disabled=true;container.style.opacity='0.5'}else{slider.disabled=false;saveButton.disabled=false;container.style.opacity='1'}const formData=new FormData();formData.append('brightness_auto_mode',isAuto?'on':'');formData.append('brightness_auto_mode_present','1');fetch('/api/save',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status!=='success'){showInputFeedback(checkbox,'error')}})}
function saveMainBrightness(btn){showButtonFeedback(btn,'loading','Applying...');const value=document.getElementById('main_brightness').value;const formData=new FormData();formData.append('default_brightness',value);fetch('/api/save',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Applied!')}else{showButtonFeedback(btn,'error','Error')}}).catch(e=>{showButtonFeedback(btn,'error','Failed')})}
function restart(){showConfirmModal('ðŸ”„ Restart Device','Are you sure you want to restart the device?',()=>{showLoading('Restarting device...');fetch('/api/restart',{method:'POST'}).then(()=>{showToast('Device is restarting...','success');setTimeout(()=>location.reload(),10000)}).catch(()=>{hideLoading();showToast('Failed to restart device','error')})})}
function factoryReset(){showConfirmModal('ðŸ­ Factory Reset','Are you sure you want to reset to factory defaults? This cannot be undone!',()=>{showConfirmModal('âš ï¸ Confirm Factory Reset','This will erase ALL your settings. Are you absolutely sure?',()=>{showLoading('Performing factory reset...');fetch('/api/factory-reset',{method:'POST'}).then(()=>{showToast('Factory reset complete. Restarting...','success');setTimeout(()=>location.reload(),5000)}).catch(()=>{hideLoading();showToast('Failed to perform factory reset','error')})})})}
function addImageSource(btn){const url=prompt('Enter image URL:');if(url&&url.trim()){if(!url.match(/^https?:\/\/.+/i)){showToast('Invalid URL format. Must start with http:// or https://','error');return}showButtonFeedback(btn,'loading','Adding...');const formData=new FormData();formData.append('url',url.trim());fetch('/api/add-source',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Added!');showToast('Image source added successfully','success');setTimeout(()=>location.reload(),1000)}else{showButtonFeedback(btn,'error','Error');showToast('Error: '+data.message,'error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Failed to add image source','error')})}}
function removeImageSource(index,btn){showConfirmModal('ðŸ—‘ï¸ Remove Image Source','Are you sure you want to remove this image source?',()=>{showButtonFeedback(btn,'loading','Removing...');const formData=new FormData();formData.append('index',index);fetch('/api/remove-source',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Removed!');showToast('Image source removed','success');setTimeout(()=>location.reload(),1000)}else{showButtonFeedback(btn,'error','Error');showToast('Failed to remove source','error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})})}
function updateImageSource(index,input){const url=input.value;if(!validateImageUrl(input))return;const formData=new FormData();formData.append('index',index);formData.append('url',url);const errorDiv=document.getElementById('imageError_'+index);if(errorDiv)errorDiv.style.display='none';fetch('/api/update-source',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status!=='success'){showInputFeedback(input,'error');showToast('Error: '+data.message,'error');if(data.message&&errorDiv){errorDiv.textContent='âš ï¸ '+data.message;errorDiv.style.display='block'}}else{showInputFeedback(input,'success');showToast('Source updated','success');if(data.warning&&errorDiv){errorDiv.textContent='âš ï¸ WARNING: '+data.warning;errorDiv.style.display='block';errorDiv.style.borderLeftColor='#f59e0b';errorDiv.style.backgroundColor='rgba(245,158,11,0.1)'}}}).catch(error=>{showInputFeedback(input,'error');showToast('Network error','error')})}
function clearAllSources(btn){showConfirmModal('ðŸ—‘ï¸ Clear All Sources','Are you sure you want to clear all image sources? This will reset to a single default source.',()=>{showButtonFeedback(btn,'loading','Clearing...');fetch('/api/clear-sources',{method:'POST'}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Cleared!');showToast('All sources cleared','success');setTimeout(()=>location.reload(),1000)}else{showButtonFeedback(btn,'error','Error');showToast('Failed to clear sources','error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})})}
function toggleTransformSection(index){const section=document.getElementById('transformSection_'+index);if(section){section.style.display=section.style.display==='none'?'block':'none'}}
function updateImageTransform(index,property,input){const value=input.value;const formData=new FormData();formData.append('index',index);formData.append('property',property);formData.append('value',value);fetch('/api/update-transform',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status!=='success'){showInputFeedback(input,'error');showToast('Failed to update transform','error')}else{showInputFeedback(input,'success')}}).catch(error=>{showInputFeedback(input,'error');showToast('Network error','error')})}
function copyDefaultsToImage(index,btn){showConfirmModal('ðŸ“‹ Copy Global Defaults','Are you sure you want to copy global default transformation settings to this image?',()=>{showButtonFeedback(btn,'loading','Copying...');const formData=new FormData();formData.append('index',index);fetch('/api/copy-defaults',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Copied!');showToast('Defaults copied successfully','success');setTimeout(()=>location.reload(),1000)}else{showButtonFeedback(btn,'error','Error');showToast('Failed to copy defaults','error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})})}
function applyTransformImmediately(index,btn){showConfirmModal('âš™ï¸ Apply Transform','Apply these transformation settings immediately?',()=>{showButtonFeedback(btn,'loading','Applying...');const formData=new FormData();formData.append('index',index);fetch('/api/apply-transform',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Applied!');showToast('Transform applied','success')}else{showButtonFeedback(btn,'error','Error');showToast('Failed to apply transform','error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})})}
function nextImage(btn){showButtonFeedback(btn,'loading','Switching...');fetch('/api/next-image',{method:'POST'}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Switched!');showToast('Switched to next image','success');setTimeout(()=>location.reload(),2000)}else{showButtonFeedback(btn,'error','Error');showToast('Failed to switch image','error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})}
function toggleSelectAll(checked){const checkboxes=document.querySelectorAll('.image-select-checkbox');checkboxes.forEach(cb=>cb.checked=checked);updateBulkDeleteButton()}
function updateBulkDeleteButton(){const checkboxes=document.querySelectorAll('.image-select-checkbox');const selected=Array.from(checkboxes).filter(cb=>cb.checked);const count=selected.length;const countSpan=document.getElementById('selectedCount');const bulkBtn=document.getElementById('bulkDeleteBtn');const selectAllCb=document.getElementById('selectAllImages');if(countSpan)countSpan.textContent=count;if(bulkBtn)bulkBtn.style.display=count>0?'inline-flex':'none';if(selectAllCb)selectAllCb.checked=(count>0&&count===checkboxes.length)}
function bulkDeleteSelected(btn){const checkboxes=document.querySelectorAll('.image-select-checkbox');const selected=Array.from(checkboxes).filter(cb=>cb.checked);const indices=selected.map(cb=>parseInt(cb.getAttribute('data-index')));if(indices.length===0){showToast('No images selected','warning');return}const total=checkboxes.length;if(indices.length===total){showToast('Cannot delete all sources. At least one must remain.','error');return}showConfirmModal('ðŸ—‘ï¸ Delete Selected Images','Are you sure you want to delete '+indices.length+' selected image source(s)?',()=>{showButtonFeedback(btn,'loading','Deleting...');const formData=new FormData();formData.append('indices',JSON.stringify(indices));fetch('/api/bulk-delete-sources',{method:'POST',body:formData}).then(response=>response.json()).then(data=>{if(data.status==='success'){showButtonFeedback(btn,'success','Deleted!');showToast(data.message||'Selected sources deleted','success');setTimeout(()=>location.reload(),1000)}else{showButtonFeedback(btn,'error','Error');showToast('Error: '+data.message,'error')}}).catch(error=>{showButtonFeedback(btn,'error','Failed');showToast('Network error','error')})})}
)rawliteral";

const char HTML_MODALS[] PROGMEM = R"rawliteral(
<div id='modal' class='modal'><div class='modal-content'>
<div class='modal-header'><h2 class='modal-title'></h2><button class='modal-close' onclick='closeModal()'>&times;</button></div>
<div class='modal-body'></div>
<div class='modal-footer'><button class='modal-btn modal-btn-confirm' onclick='closeModal()'>OK</button></div>
</div></div>
<div id='confirmModal' class='modal'><div class='modal-content'>
<div class='modal-header'><h2 class='modal-title'></h2><button class='modal-close' onclick='closeModal()'>&times;</button></div>
<div class='modal-body'></div>
<div class='modal-footer'><button class='modal-btn modal-btn-cancel'>Cancel</button><button class='modal-btn modal-btn-confirm'>Confirm</button></div>
</div></div>
)rawliteral";

#endif // WEB_CONFIG_HTML_H
